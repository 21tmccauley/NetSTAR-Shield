<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/tabs/HomeTab.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/tabs/HomeTab.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useEffect, useState } from "react";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import {
  Lock,
  GlobeLock,
  KeyRound,
  Network,
  CheckCircle2,
  AlertCircle,
  ZoomIn,
  ScrollText,
  FileUser,
  NotebookText,
} from "lucide-react";
import { getStatusFromScore, getStatusMessage } from "@/lib/securityUtils";
import { getColorClasses } from "@/lib/themeUtils";
import { DEFAULT_INDICATOR_DATA } from "@/lib/constants";

/**
 * Mapping of indicator IDs to their corresponding icon components from lucide-react
 * @type {Object&lt;string, React.ComponentType>}
 * @constant
 * @memberof module:Front End
 */
const INDICATOR_ICONS = {
  cert: ScrollText,
  connection: Lock,
  domain: GlobeLock,
  credentials: KeyRound,
  ip: Network,
  dns: NotebookText,
  whois: FileUser,
};

/**
 * localStorage key used to persist the expanded/collapsed state of the "What We Checked" section
 * @type {string}
 * @constant
 * @memberof module:Front End
 */
const INDICATORS_OPEN_KEY = "indicatorsOpen";

/**
 * HomeTab component - Main tab displaying security score and indicators for the current website
 * 
 * @component
 * @memberof module:Front End
 * @param {Object} props - Component props
 * @param {string} props.mode - Current theme mode: "light" or "dark"
 * @param {Function} props.onNavigate - Callback function to navigate to other tabs/pages
 * @param {Function} props.onNavigate.details - Navigate to details tab with indicator data
 * @param {boolean|undefined} props.forceShowIndicators - Force indicators to be shown (used by tour/guided experiences). 
 *   When provided, overrides user's saved preference
 * @returns {JSX.Element} The rendered HomeTab component
 * 
 * @example
 * ```jsx
 * &lt;HomeTab 
 *   mode="dark" 
 *   onNavigate={(tab, data) => setActiveTab(tab)} 
 *   forceShowIndicators={true} 
 * />
 * ```
 */
export function HomeTab({ mode, onNavigate, forceShowIndicators }) {
  /** Current website URL hostname */
  const [currentUrl, setCurrentUrl] = useState("");
  
  /** Security safety score (0-100), default is 87 */
  const [safetyScore, setSafetyScore] = useState(87);
  
  /** Complete security scan data including indicators and metadata, or null if not loaded */
  const [securityData, setSecurityData] = useState(null);

  /**
   * State for whether the "What We Checked" indicators section is expanded
   * Initialized from localStorage to persist user's preference across sessions
   * @type {boolean}
   */
  const [showIndicators, setShowIndicators] = useState(() => {
    try {
      if (typeof window === "undefined") return false;
      const saved = window.localStorage.getItem(INDICATORS_OPEN_KEY);
      return saved ? saved === "1" : false;
    } catch {
      return false;
    }
  });

  /**
   * Computed indicator visibility state - allows external control (tour) to override user preference
   * @type {boolean}
   * @memberof module:Front End~HomeTab
   */
  const computedShowIndicators =
    forceShowIndicators ?? showIndicators;

  /**
   * Effect to persist user's indicator toggle preference to localStorage
   * Runs whenever showIndicators changes, but does not persist forced overrides
   * @memberof module:Front End~HomeTab
   */
  useEffect(() => {
    try {
      if (typeof window !== "undefined") {
        window.localStorage.setItem(
          INDICATORS_OPEN_KEY,
          showIndicators ? "1" : "0"
        );
      }
    } catch {
      /* ignore write errors */
    }
  }, [showIndicators]);

  /**
   * Effect to fetch current tab URL and security data from background script
   * Runs once on component mount to populate initial security information
   * @memberof module:Front End~HomeTab
   */
  useEffect(() => {
    if (typeof chrome !== "undefined" &amp;&amp; chrome.runtime) {
      chrome.runtime.sendMessage({ action: "getCurrentTab" }, (response) => {
        if (response &amp;&amp; response.url) {
          try {
            const url = new URL(response.url);
            setCurrentUrl(url.hostname);
          } catch (e) {
            setCurrentUrl("this site");
          }

          // Update safety score &amp; data from background script if available
          if (response.securityData &amp;&amp; response.securityData.safetyScore) {
            setSafetyScore(response.securityData.safetyScore);
            setSecurityData(response.securityData);
          }
        }
      });
    } else {
      setCurrentUrl("example.com");
    }
  }, []);

  /**
   * Builds indicator list by merging default indicator data with live security scan data
   * Maps indicator IDs to icons and merges scores from securityData when available
   * Sorts indicators by score in ascending order (lowest scores first)
   * @type {Array&lt;Object>}
   * @property {string} id - Indicator identifier
   * @property {string} name - Display name for the indicator
   * @property {number} score - Security score (0-100)
   * @property {React.ComponentType} icon - Icon component for the indicator
   * @memberof module:Front End~HomeTab
   */
  const indicators = DEFAULT_INDICATOR_DATA
  .sort(((a, b) => a.score - b.score))
    .map((data) => ({
      ...data,
      score: securityData?.indicators?.[data.id]?.score ?? data.score ?? 0,
      icon: INDICATOR_ICONS[data.id],
    }))

  /**
   * Handler function to toggle the visibility of the "What We Checked" indicators section
   * Prevents toggling when a forced override is active (e.g., during a tour)
   * @memberof module:Front End~HomeTab
   * @function handleToggleIndicators
   */
  const handleToggleIndicators = () => {
    // If a forced value is provided (tour/demo), don't toggle the persisted state
    if (forceShowIndicators != null) return;
    setShowIndicators((openState) => !openState);
  };
  return (
    &lt;div className="p-6">
      {/* Header with friendly greeting */}
      &lt;div className="text-center mb-6">
        &lt;h2
          className={`font-bold text-xl mb-1 ${
            mode === "dark" ? "text-white" : "text-slate-900"
          }`}
        >
          You're Safe Here!
        &lt;/h2>
        &lt;p
          className={`text-sm ${
            mode === "dark" ? "text-slate-200" : "text-brand-600"
          }`}
        >
          {currentUrl} is looking good
        &lt;/p>
      &lt;/div>

      {/* Friendly Score Display */}
      &lt;div
        id="security-score"
        className={`rounded-2xl p-6 mb-6 ${
          mode === "dark"
            ? "bg-gradient-to-br from-brand-900/50 to-brand-accent-500/30"
            : "bg-gradient-to-br from-brand-100 to-brand-accent-400/20"
        }`}
      >
        &lt;div className="text-center">
          &lt;div className="inline-flex items-baseline gap-2 mb-2">
            &lt;span
              className={`text-6xl font-bold bg-gradient-to-r ${
                getColorClasses(getStatusFromScore(safetyScore)).gradient
              } bg-clip-text text-transparent`}
            >
              {safetyScore}
            &lt;/span>
            &lt;span
              className={`text-2xl font-medium ${
                mode === "dark" ? "text-slate-100" : "text-brand-600"
              }`}
            >
              /100
            &lt;/span>
          &lt;/div>
          &lt;div
            className={`text-sm font-medium ${
              mode === "dark" ? "text-slate-100" : "text-brand-700"
            }`}
          >
            Safety Score
          &lt;/div>
          &lt;div className="flex items-center justify-center gap-1 mt-3">
            {[...Array(5)].map((_, i) => {
              const segmentFill = Math.min(
                Math.max((safetyScore - i * 20) / 20, 0),
                1
              );
              const colors = getColorClasses(getStatusFromScore(safetyScore));

              return (
                &lt;div
                  key={i}
                  className={`relative w-8 h-1.5 rounded-full overflow-hidden ${
                    mode === "dark" ? "bg-slate-700" : "bg-brand-200"
                  }`}
                >
                  &lt;div
                    className={`absolute inset-y-0 left-0 transition-all ${
                      segmentFill > 0 ? `bg-gradient-to-r ${colors.gradient}` : ""
                    }`}
                    style={{ width: `${segmentFill * 100}%` }}
                  />
                &lt;/div>
              );
            })}
          &lt;/div>
        &lt;/div>
      &lt;/div>

      {/* Friendly Indicators */}
      &lt;div id="security-indicators" className="space-y-3">
        &lt;button
          onClick={handleToggleIndicators}
          className={`text-sm font-semibold mb-3 flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity ${
            mode === "dark" ? "text-white" : "text-brand-800"
          }`}
        >
          &lt;ZoomIn className="h-4 w-4" />
          What We Checked
          &lt;span className="text-xs ml-auto">
            {computedShowIndicators ? "▼" : "▶"}
          &lt;/span>
        &lt;/button>

        {computedShowIndicators &amp;&amp;
          indicators.map((indicator) => {
            const Icon = indicator.icon;
            const status = getStatusFromScore(indicator.score);
            const colors = getColorClasses(status);

            return (
              &lt;button
                key={indicator.id}
                onClick={() => onNavigate("details", { ...indicator, status })}
                className={`w-full flex items-center gap-3 p-4 rounded-xl transition-all hover:scale-[1.02] ${
                  mode === "dark"
                    ? "bg-slate-800/50 hover:bg-slate-800"
                    : "bg-white hover:shadow-md"
                }`}
              >
                &lt;div className={`p-2 rounded-lg ${colors.bg}`}>
                  &lt;Icon className={`h-4 w-4 ${colors.text}`} />
                &lt;/div>
                &lt;div className="flex-1 text-left">
                  &lt;div
                    className={`text-sm font-medium ${
                      mode === "dark" ? "text-white" : "text-slate-900"
                    }`}
                  >
                    {indicator.name}
                  &lt;/div>
                  &lt;div
                    className={`text-xs ${
                      mode === "dark" ? "text-slate-300" : "text-slate-600"
                    }`}
                  >
                    {getStatusMessage(status)}
                  &lt;/div>
                &lt;/div>
                {status === "excellent" || status === "good" ? (
                  &lt;CheckCircle2 className="h-5 w-5 text-green-500" />
                ) : status === "moderate" ? (
                  &lt;AlertCircle className="h-5 w-5 text-amber-500" />
                ) : (
                  &lt;AlertCircle className="h-5 w-5 text-red-500" />
                )}
              &lt;/button>
            );
          })}
      &lt;/div>
    &lt;/div>
  );
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Back%2520End.html">Back End</a></li><li><a href="module-Front%2520End.html">Front End</a></li><li><a href="module-Testing.html">Testing</a></li></ul><h3>Global</h3><ul><li><a href="global.html#EDUCATIONAL_CONTENT">EDUCATIONAL_CONTENT</a></li><li><a href="global.html#ThemeToggleIcon">ThemeToggleIcon</a></li><li><a href="global.html#getColorClasses">getColorClasses</a></li><li><a href="global.html#getDetailedStatusMessage">getDetailedStatusMessage</a></li><li><a href="global.html#getEducationalContent">getEducationalContent</a></li><li><a href="global.html#getStatusFromScore">getStatusFromScore</a></li><li><a href="global.html#getStatusInfo">getStatusInfo</a></li><li><a href="global.html#getStatusMessage">getStatusMessage</a></li><li><a href="global.html#themeValue">themeValue</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Fri Nov 14 2025 09:14:54 GMT-0700 (Mountain Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
